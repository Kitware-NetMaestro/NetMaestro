<div class="card bg-base-100 w-1/2">
	<div class="card-body">
		<h2 class="card-title text-white">
			Scatter Plot
		</h2>
		<div id="scatterPlot" style="width:800px;height:400px;"></div>
	</div>
</div>

<script>
	let records, columns, x_values, y_values

	async function getRossData() {
		const response = await fetch('api/v1/data/ross')
		const data = await response.json()
		columns = data.columns
		records = data.data
		updatePlotData()
	}
	function updatePlotData(){
		x_values = records.map(record => record.events_processed)
		y_values = records.map(record => record.events_rolled_back)
		color_range = records.map(record => record.PE_ID)
		Plotly.update(scatterPlot, {
			x: [x_values],
			y: [y_values],
			marker:{
				color: color_range,
				colorscale: 'Blues'
			}
		})

	}
	Plotly.newPlot( scatterPlot, [{
			x: [],
			y: [],
			mode: 'markers',
			type: 'scatter',
			showlegend: true,

		}], {
			xaxis: {
				title: {
					text: 'Events Processed'
				},
				rangemode: 'tozero',
				color: 'white',
			},
			yaxis: {
				title: {
					text: 'Events Rolled Back'
				},
				rangemode: 'tozero',
				color: 'white',
			},
			paper_bgcolor: '1d232a',
			plot_bgcolor: '1d232a',
			margin: {
				l: 50,
				r: 50,
				b: 50,
				t: 50,
				pad: 4
			}

		})
	scatterPlot = document.getElementById('scatterPlot');

	document.addEventListener('DOMContentLoaded', getRossData);
</script>
